version: 2

models:
  - name: src_customer
    description: >
      Raw customer data persisted without transformation.
      This is the first layer in the five-layer architecture, capturing data exactly as received from CSV files.
      All fields stored as strings to allow invalid data to flow to quarantine tables for validation.
    config:
      contract:
        enforced: true
    columns:
      - name: customer_id
        description: Unique identifier for the customer (string to handle invalid data)
        data_type: string
      
      - name: name
        description: Customer name as provided in source file
        data_type: string
      
      - name: has_loan
        description: Raw indicator of whether customer has a loan
        data_type: string
      
      - name: loaded_at
        description: Timestamp when the data was loaded into the source layer
        data_type: timestamp
        constraints:
          - type: not_null
        tests:
          - not_null
    
    tests:
      - dbt_utils.recency:
          datepart: day
          field: loaded_at
          interval: 7
          severity: warn

  - name: src_account
    description: >
      Raw account data persisted without transformation.
      This is the first layer in the five-layer architecture, capturing data exactly as received from CSV files.
      All fields stored as strings to allow invalid data to flow to quarantine tables for validation.
    config:
      contract:
        enforced: true
    columns:
      - name: account_id
        description: Unique identifier for the account
        data_type: string
      
      - name: customer_id
        description: Foreign key to customer (string to handle invalid data)
        data_type: string
      
      - name: balance
        description: Account balance (string to handle invalid data)
        data_type: string
      
      - name: account_type
        description: Type of account (e.g., Savings, Checking)
        data_type: string
      
      - name: loaded_at
        description: Timestamp when the data was loaded into the source layer
        data_type: timestamp
        constraints:
          - type: not_null
        tests:
          - not_null
    
    tests:
      - dbt_utils.recency:
          datepart: day
          field: loaded_at
          interval: 7
          severity: warn
